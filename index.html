<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Surprise For You</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Noto+Sans+Thai:wght@300;400;600&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
        :root{
            --bg:#0a0008;--primary:#ff2d55;--soft:#ff6b9d;--gold:#ffd700;
            --rose:#b76e79;--text:#fff5f5;--dim:rgba(255,245,245,.45);
            --cursive:'Great Vibes',cursive;--thai:'Noto Sans Thai',sans-serif;
            --sans:'Montserrat',sans-serif;--vh:1vh
        }
        html,body{width:100%;height:100%;overflow:hidden;background:var(--bg);color:var(--text);font-family:var(--thai);-webkit-tap-highlight-color:transparent}

        /* ===== CINEMATIC BACKGROUND ===== */
        #bgCanvas{position:fixed;inset:0;z-index:0;pointer-events:none}
        #bgGrad{position:fixed;inset:0;z-index:0;pointer-events:none;
            background:
                radial-gradient(ellipse 80% 60% at 20% 80%, rgba(120,20,60,.25) 0%, transparent 60%),
                radial-gradient(ellipse 70% 50% at 80% 20%, rgba(60,10,80,.2) 0%, transparent 60%),
                radial-gradient(ellipse 90% 70% at 50% 50%, rgba(30,5,40,.4) 0%, transparent 70%),
                linear-gradient(170deg, #0a0008 0%, #12001a 30%, #0d0010 60%, #08000a 100%);
            animation:bgShift 20s ease-in-out infinite alternate
        }
        @keyframes bgShift{
            0%{filter:hue-rotate(0deg) brightness(1)}
            50%{filter:hue-rotate(8deg) brightness(1.05)}
            100%{filter:hue-rotate(-5deg) brightness(.98)}
        }
        /* Soft moving ambient light */
        #ambLight{position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.6}
        .amb-orb{position:absolute;border-radius:50%;filter:blur(80px);animation:orbFloat var(--d) ease-in-out infinite alternate;will-change:transform,opacity}
        @keyframes orbFloat{
            0%{transform:translate(0,0) scale(1);opacity:var(--o1,.15)}
            100%{transform:translate(var(--tx),var(--ty)) scale(var(--s,1.2));opacity:var(--o2,.08)}
        }

        /* Stars – warm tinted */
        #bgStars{position:fixed;inset:0;pointer-events:none;z-index:1}
        .star{position:absolute;border-radius:50%;background:radial-gradient(circle,#ffe8d6,#fff);animation:twinkle var(--d) ease-in-out infinite;animation-delay:var(--dl)}
        @keyframes twinkle{0%,100%{opacity:.08;transform:scale(.6)}50%{opacity:.7;transform:scale(1.2)}}

        /* Floating hearts – subtle, small */
        #bgHearts{position:fixed;inset:0;pointer-events:none;z-index:1}
        .fh{position:absolute;bottom:-30px;opacity:0;pointer-events:none;animation:fhUp var(--d) linear infinite;animation-delay:var(--dl);font-size:var(--sz);color:rgba(255,107,157,.5)}
        @keyframes fhUp{0%{transform:translateY(0) rotate(0);opacity:0}8%{opacity:var(--mo,.15)}50%{transform:translateY(-55vh) rotate(180deg) translateX(var(--dx,10px))}85%{opacity:var(--mo,.15)}100%{transform:translateY(-115vh) rotate(360deg);opacity:0}}

        /* Bokeh particles (replace emoji) */
        #bgBokeh{position:fixed;inset:0;pointer-events:none;z-index:1}
        .bokeh{position:absolute;border-radius:50%;background:radial-gradient(circle,rgba(255,180,210,.6),transparent 70%);animation:bokehDrift var(--d) ease-in-out infinite;animation-delay:var(--dl);opacity:0}
        @keyframes bokehDrift{
            0%{opacity:0;transform:translate(0,0) scale(.3)}
            20%{opacity:var(--mo,.08)}
            50%{transform:translate(var(--dx),var(--dy)) scale(1)}
            80%{opacity:var(--mo,.08)}
            100%{opacity:0;transform:translate(0,0) scale(.3)}
        }

        /* ===== TRANSITION ===== */
        #transOverlay{position:fixed;inset:0;z-index:500;background:radial-gradient(circle,rgba(255,45,85,.12),rgba(10,0,8,.95) 70%);opacity:0;pointer-events:none;transition:opacity .5s ease;backdrop-filter:blur(0px)}
        #transOverlay.on{opacity:1;backdrop-filter:blur(4px)}

        /* ===== SLIDES ===== */
        .slide{position:fixed;inset:0;z-index:10;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:1.5rem;opacity:0;visibility:hidden;transform:scale(1.04);transition:opacity .7s ease,transform .7s ease,visibility .7s,filter .7s}
        .slide.active{opacity:1;visibility:visible;transform:scale(1);filter:blur(0)}
        .slide.leaving{opacity:0;transform:scale(.94);visibility:visible;filter:blur(3px)}

        /* ===== INTRO ===== */
        .intro-sub{font-family:var(--sans);font-weight:300;font-size:clamp(.72rem,2vw,.95rem);letter-spacing:4px;text-transform:uppercase;margin-bottom:2.5rem;opacity:0;animation:fadeUp 1.2s ease .5s forwards;color:rgba(255,200,220,.5);text-shadow:0 0 20px rgba(255,107,157,.15)}
        .env-wrap{cursor:pointer;margin-bottom:2rem;opacity:0;animation:fadeUp 1s ease 1s forwards}
        .envelope{width:clamp(200px,50vw,280px);height:clamp(140px,35vw,190px);position:relative;perspective:800px}
        .env-body{width:100%;height:100%;background:linear-gradient(145deg,#c9956b,#a87544);border-radius:4px;position:relative;box-shadow:0 15px 50px rgba(255,29,68,.15),0 5px 20px rgba(0,0,0,.5)}
        .env-body::after{content:'';position:absolute;inset:8px;border:1px solid rgba(255,255,255,.08);border-radius:2px}
        .env-flap{position:absolute;top:0;left:0;width:100%;height:55%;background:linear-gradient(165deg,#d4a574,#b8854a);clip-path:polygon(0 0,50% 100%,100% 0);transform-origin:top center;transition:transform .8s cubic-bezier(.4,0,.2,1);z-index:2}
        .env-wrap.opened .env-flap{transform:rotateX(180deg)}
        .env-inner{position:absolute;top:0;left:0;width:100%;height:55%;background:linear-gradient(165deg,#f5e6d3,#e8d5c0);clip-path:polygon(0 0,50% 100%,100% 0);z-index:1}
        .env-seal{position:absolute;top:28%;left:50%;transform:translate(-50%,-50%);z-index:3;width:48px;height:48px;background:radial-gradient(circle,#ff2d55,#c41e3a);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:22px;color:#fff;box-shadow:0 0 20px rgba(255,45,85,.4);animation:sealPulse 2.5s ease-in-out infinite;transition:opacity .5s,transform .5s}
        .env-wrap.opened .env-seal{opacity:0;transform:translate(-50%,-50%) scale(2)}
        @keyframes sealPulse{0%,100%{box-shadow:0 0 20px rgba(255,45,85,.4)}50%{box-shadow:0 0 40px rgba(255,45,85,.6)}}
        .env-letter{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);width:72%;height:0;background:#fff;border-radius:3px 3px 0 0;transition:height .6s cubic-bezier(.4,0,.2,1) .35s;display:flex;align-items:center;justify-content:center;overflow:hidden}
        .env-letter span{color:var(--primary);font-family:var(--thai);font-weight:600;font-size:clamp(.65rem,2.3vw,.85rem);white-space:nowrap;opacity:0;transition:opacity .5s ease .9s}
        .env-wrap.opened .env-letter{height:48px}
        .env-wrap.opened .env-letter span{opacity:1}
        .start-btn{font-family:var(--thai);font-weight:300;font-size:.85rem;letter-spacing:3px;color:rgba(255,200,220,.8);background:rgba(255,45,85,.06);border:1px solid rgba(255,107,157,.2);padding:14px 48px;border-radius:50px;cursor:pointer;position:relative;overflow:hidden;transition:all .5s;opacity:0;animation:fadeUp 1s ease 1.5s forwards;text-shadow:0 0 15px rgba(255,107,157,.2)}
        .start-btn::before{content:'';position:absolute;inset:-1px;background:linear-gradient(135deg,var(--primary),#e91e63,var(--soft));opacity:0;transition:opacity .5s;border-radius:50px;z-index:-1}
        .start-btn:hover::before,.start-btn:active::before{opacity:1}
        .start-btn:hover,.start-btn:active{color:#fff;border-color:transparent;transform:scale(1.05);box-shadow:0 0 40px rgba(255,45,85,.25)}
        .start-btn span{position:relative;z-index:1}

        /* ===== MESSAGE ===== */
        .msg-card{background:rgba(255,255,255,.03);border:1px solid rgba(255,107,157,.1);border-radius:24px;padding:clamp(2rem,5vw,3rem);max-width:540px;width:92%;text-align:center;backdrop-filter:blur(16px);box-shadow:0 25px 80px rgba(0,0,0,.4),0 0 60px rgba(255,45,85,.05),inset 0 1px 0 rgba(255,255,255,.05);transform:scale(.85);opacity:0;transition:transform 1s cubic-bezier(.175,.885,.32,1.275) .15s,opacity .9s .15s}
        .slide.active .msg-card{transform:scale(1);opacity:1}
        .msg-card .icon{font-size:2.8rem;margin-bottom:1.2rem;display:block;filter:drop-shadow(0 0 12px rgba(255,107,157,.3))}
        .msg-card .tw-text{font-size:clamp(1rem,3.2vw,1.2rem);line-height:2.1;min-height:3rem;color:#ffd4e0;text-shadow:0 0 25px rgba(255,107,157,.2)}
        .tw-cursor{display:inline-block;width:2px;height:1.1em;background:var(--soft);margin-left:2px;vertical-align:text-bottom;animation:blink .6s step-end infinite}
        @keyframes blink{50%{opacity:0}}

        /* ===== PHOTO ===== */
        .photo-cap{font-size:clamp(.9rem,3vw,1.15rem);color:#ffcce0;text-align:center;max-width:500px;margin-bottom:clamp(.8rem,2vw,1.2rem);min-height:1.8em;line-height:1.8;text-shadow:0 0 20px rgba(255,107,157,.3),0 2px 12px rgba(0,0,0,.6)}
        .photo-frame{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:clamp(8px,2vw,14px);box-shadow:0 25px 80px rgba(0,0,0,.5),0 0 40px rgba(255,45,85,.08),inset 0 1px 0 rgba(255,255,255,.08);opacity:0;transform:scale(0) rotate(-5deg);will-change:transform,opacity;backdrop-filter:blur(8px)}
        .photo-frame img{display:block;border-radius:8px;width:auto;height:auto;max-width:min(88vw,500px);max-height:calc(var(--vh,1vh)*55);object-fit:contain}
        .photo-counter{margin-top:.8rem;font-family:var(--sans);font-size:.65rem;color:rgba(200,160,180,.5);letter-spacing:4px;text-transform:uppercase}

        .anim-active.a-pop{animation:photoPop 1s cubic-bezier(.175,.885,.32,1.275) forwards}
        .anim-active.a-slideUp{animation:photoSlideUp 1s cubic-bezier(.175,.885,.32,1.275) forwards}
        .anim-active.a-zoom{animation:photoZoom 1.1s cubic-bezier(.175,.885,.32,1.275) forwards}
        .anim-active.a-rotateIn{animation:photoRotateIn 1.1s cubic-bezier(.175,.885,.32,1.275) forwards}
        .anim-active.a-drop{animation:photoDrop 1s cubic-bezier(.175,.885,.32,1.275) forwards}
        .photo-float{animation:photoFloat 3.5s ease-in-out infinite}
        @keyframes photoFloat{0%,100%{transform:translateY(0) rotate(0)}50%{transform:translateY(-5px) rotate(.3deg)}}

        @keyframes photoPop{0%{transform:scale(0) rotate(-5deg);opacity:0}55%{transform:scale(1.06) rotate(1.5deg);opacity:1}75%{transform:scale(.97) rotate(-.5deg)}100%{transform:scale(1) rotate(0);opacity:1}}
        @keyframes photoSlideUp{0%{transform:translateY(80px) scale(.7) rotate(3deg);opacity:0}55%{transform:translateY(-8px) scale(1.04) rotate(-1deg);opacity:1}100%{transform:translateY(0) scale(1) rotate(0);opacity:1}}
        @keyframes photoZoom{0%{transform:scale(1.8);opacity:0;filter:blur(15px)}100%{transform:scale(1);opacity:1;filter:blur(0)}}
        @keyframes photoRotateIn{0%{transform:scale(0) rotate(-180deg);opacity:0}55%{transform:scale(1.05) rotate(4deg);opacity:1}100%{transform:scale(1) rotate(0);opacity:1}}
        @keyframes photoDrop{0%{transform:translateY(-100px) scale(.6) rotate(-8deg);opacity:0}45%{transform:translateY(15px) scale(1.05) rotate(2deg);opacity:1}65%{transform:translateY(-5px) scale(.98) rotate(-.5deg)}100%{transform:translateY(0) scale(1) rotate(0);opacity:1}}

        /* ===== VIDEO ===== */
        .video-outer{width:min(94vw,720px);max-height:calc(var(--vh,1vh)*70);border-radius:16px;overflow:hidden;box-shadow:0 30px 100px rgba(0,0,0,.6),0 0 60px rgba(255,45,85,.06);background:#000;transform:scale(.85);opacity:0;transition:transform .9s cubic-bezier(.175,.885,.32,1.275) .1s,opacity .8s .1s;border:1px solid rgba(255,255,255,.05)}
        .slide.active .video-outer{transform:scale(1);opacity:1}
        .video-outer video{display:block;width:100%;height:auto;max-height:calc(var(--vh,1vh)*70);object-fit:contain}
        .video-label{margin-top:1rem;font-family:var(--sans);font-size:.7rem;color:rgba(200,160,180,.45);letter-spacing:3px}

        /* ===== FINALE ===== */
        .finale-bouquet{opacity:0;transform:scale(0) rotate(-15deg);transition:transform 1.6s cubic-bezier(.175,.885,.32,1.275),opacity 1s;filter:drop-shadow(0 0 50px rgba(255,200,220,.4));margin-bottom:1.5rem;text-align:center}
        .finale-bouquet img{width:auto;height:auto;max-width:min(65vw,300px);max-height:calc(var(--vh,1vh)*38);object-fit:contain}
        .slide.active .finale-bouquet{opacity:1;transform:scale(1) rotate(0)}
        .finale-bouquet.float{animation:bouquetFloat 4s ease-in-out infinite}
        @keyframes bouquetFloat{0%,100%{transform:translateY(0) rotate(0)}50%{transform:translateY(-6px) rotate(.5deg)}}
        .finale-lines{text-align:center;min-height:100px;max-height:calc(var(--vh,1vh)*48);overflow-y:auto;padding:0 .5rem;-webkit-overflow-scrolling:touch;scrollbar-width:none}
        .finale-lines::-webkit-scrollbar{display:none}
        .finale-line{font-size:clamp(1.05rem,3.6vw,1.4rem);line-height:2;opacity:0;transform:translateY(20px);transition:opacity .8s,transform .8s;color:#ffc8dd;text-shadow:0 0 25px rgba(255,107,157,.25)}
        .finale-line.shown{opacity:1;transform:translateY(0)}
        .finale-divider{font-size:1rem;opacity:0;transform:scale(0);transition:opacity .8s,transform .8s cubic-bezier(.175,.885,.32,1.275);letter-spacing:10px;line-height:2.5;color:rgba(255,215,0,.5)}
        .finale-divider.shown{opacity:1;transform:scale(1)}
        .finale-poem{font-size:clamp(.9rem,3vw,1.15rem);line-height:2.2;color:rgba(200,170,210,.15);opacity:0;transform:translateY(20px);transition:opacity .9s,transform .9s,color .9s,text-shadow .9s}
        .finale-poem.shown{opacity:1;transform:translateY(0);color:#d8b4e8;text-shadow:0 0 20px rgba(180,130,220,.25)}
        /* Climax: last poem line bigger + glow */
        .finale-poem.climax.shown{font-size:clamp(1.05rem,3.4vw,1.3rem);color:#f0d0ff;text-shadow:0 0 30px rgba(200,150,255,.4)}

        /* ===== NAV ===== */
        .nav-next{position:fixed;bottom:max(env(safe-area-inset-bottom,0px) + 24px,28px);right:clamp(16px,4vw,36px);z-index:100;width:54px;height:54px;border-radius:50%;background:linear-gradient(135deg,rgba(255,45,85,.7),rgba(233,30,99,.7));border:1px solid rgba(255,107,157,.2);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 35px rgba(255,45,85,.3);opacity:0;transform:scale(.4) translateY(20px);transition:opacity .5s,transform .5s cubic-bezier(.175,.885,.32,1.275);pointer-events:none;backdrop-filter:blur(8px)}
        .nav-next.show{opacity:1;transform:scale(1) translateY(0);pointer-events:auto}
        .nav-next:hover{transform:scale(1.1) translateY(0);box-shadow:0 8px 40px rgba(255,45,85,.4)}
        .nav-next:active{transform:scale(.92) translateY(0)}
        .nav-next svg{width:22px;height:22px;fill:none;stroke:#fff;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}

        /* ===== PROGRESS ===== */
        .prog{position:fixed;bottom:max(env(safe-area-inset-bottom,0px) + 28px,32px);left:50%;transform:translateX(-50%);z-index:100;display:flex;gap:6px;opacity:0;transition:opacity .5s}
        .prog.show{opacity:1}
        .pd{width:6px;height:6px;border-radius:50%;background:rgba(255,107,157,.12);transition:all .5s}
        .pd.done{background:rgba(255,107,157,.35)}
        .pd.cur{background:var(--soft);transform:scale(1.6);box-shadow:0 0 10px rgba(255,107,157,.5)}

        /* ===== MUSIC BTN ===== */
        .mu-btn{position:fixed;top:max(env(safe-area-inset-top,0px) + 12px,16px);right:16px;z-index:200;width:42px;height:42px;border-radius:50%;background:rgba(255,45,85,.08);border:1px solid rgba(255,107,157,.12);cursor:pointer;display:none;align-items:center;justify-content:center;backdrop-filter:blur(12px);transition:all .3s}
        .mu-btn.show{display:flex}
        .mu-btn:hover{background:rgba(255,45,85,.18)}
        .mbars{display:flex;align-items:flex-end;gap:2px;height:14px}
        .mbars i{width:2.5px;background:var(--soft);border-radius:1px;animation:mb .7s ease-in-out infinite alternate}
        .mbars i:nth-child(1){height:35%;animation-delay:0s}.mbars i:nth-child(2){height:65%;animation-delay:.15s}.mbars i:nth-child(3){height:45%;animation-delay:.3s}.mbars i:nth-child(4){height:75%;animation-delay:.1s}
        .mu-btn.muted .mbars i{animation:none;height:3px!important}
        @keyframes mb{0%{height:15%}100%{height:100%}}

        /* ===== FX ===== */
        .sparkle{position:fixed;pointer-events:none;z-index:800;animation:spk .8s ease-out forwards}
        @keyframes spk{0%{transform:translate(0,0) scale(0);opacity:.8}100%{transform:translate(var(--dx),var(--dy)) scale(1);opacity:0}}
        .confetti{position:fixed;z-index:900;pointer-events:none;opacity:0;animation:cfall var(--fd,3s) linear forwards;animation-delay:var(--dl,0s)}
        @keyframes cfall{0%{transform:translate(var(--xs,0),-20px) rotate(0) scale(0);opacity:0}10%{opacity:1;transform:translate(var(--xs,0),0) rotate(40deg) scale(1)}100%{transform:translate(var(--xe,30px),100vh) rotate(720deg) scale(.2);opacity:0}}
        .petal{position:fixed;pointer-events:none;z-index:50;background:radial-gradient(ellipse,rgba(255,107,157,.6),rgba(255,45,85,.3));border-radius:50% 0 50% 50%;opacity:0;animation:ptfall var(--d) linear forwards;animation-delay:var(--dl)}
        @keyframes ptfall{0%{transform:translate(0,-20px) rotate(0);opacity:0}10%{opacity:.5}100%{transform:translate(var(--dx),110vh) rotate(var(--rot,400deg));opacity:0}}
        .light-burst{position:fixed;inset:0;z-index:999;background:radial-gradient(circle,rgba(255,107,157,.3),transparent 70%);opacity:0;pointer-events:none;transition:opacity .6s}
        .light-burst.on{opacity:1}
        @keyframes fadeUp{from{opacity:0;transform:translateY(25px)}to{opacity:1;transform:translateY(0)}}

        /* Finale background glow intensify */
        .finale-glow{position:fixed;inset:0;z-index:5;pointer-events:none;opacity:0;transition:opacity 2s ease;
            background:radial-gradient(ellipse 80% 60% at 50% 50%, rgba(180,80,140,.12) 0%, transparent 70%)}
        .finale-glow.on{opacity:1}

        /* ===== WATER RIPPLE (FINALE) ===== */
        .ripple-layer{position:absolute;inset:0;pointer-events:none;overflow:hidden;z-index:6}
        .ripple-ring{position:absolute;border-radius:50%;border:1.5px solid rgba(255,200,220,.18);transform:translate(-50%,-50%);animation:rippleOut var(--d,3.5s) ease-out forwards}
        .ripple-ring:nth-child(3n+1){border-color:rgba(200,160,240,.12)}
        .ripple-ring:nth-child(3n+2){border-color:rgba(255,215,180,.12)}
        @keyframes rippleOut{
            0%{width:0;height:0;opacity:.5}
            40%{opacity:.25}
            100%{width:var(--sz,250px);height:var(--sz,250px);opacity:0}
        }

        /* ===== SLIDE DECORATIONS ===== */
        .slide-deco{position:absolute;pointer-events:none;opacity:0;animation:decoFloat var(--d,5s) ease-in-out infinite;animation-delay:var(--dl,0s);color:var(--dc,rgba(255,180,210,.3));font-size:var(--sz,14px);z-index:8;will-change:transform,opacity}
        @keyframes decoFloat{
            0%,100%{opacity:var(--o1,.12);transform:translate(0,0) rotate(0deg) scale(.85)}
            33%{transform:translate(var(--tx,5px),var(--ty,-8px)) rotate(var(--r,10deg)) scale(1.05);opacity:var(--o2,.3)}
            66%{transform:translate(calc(var(--tx,5px) * -0.6),calc(var(--ty,-8px) * 1.3)) rotate(calc(var(--r,10deg) * -0.8)) scale(.95);opacity:var(--o2,.3)}
        }

        /* ===== RESPONSIVE ===== */
        @media(max-width:480px){.slide{padding:1rem}.photo-frame img{max-width:92vw;max-height:calc(var(--vh,1vh)*48)}.photo-cap{max-width:90vw;font-size:clamp(.82rem,2.8vw,1rem)}}
        @media(min-width:768px) and (max-width:1024px){.photo-frame img{max-width:min(80vw,550px);max-height:calc(var(--vh,1vh)*55)}.video-outer{width:min(85vw,680px)}}
        @media(min-width:1025px){.photo-frame img{max-width:min(60vw,600px);max-height:calc(var(--vh,1vh)*58)}.video-outer{width:min(70vw,800px)}}
    </style>
</head>
<body>

<div id="bgGrad"></div>
<div id="ambLight"></div>
<div id="bgStars"></div>
<div id="bgHearts"></div>
<div id="bgBokeh"></div>
<div class="light-burst" id="lightBurst"></div>
<div class="finale-glow" id="finaleGlow"></div>
<div id="transOverlay"></div>

<button class="mu-btn" id="muBtn" aria-label="Toggle music">
    <div class="mbars"><i></i><i></i><i></i><i></i></div>
</button>

<!-- SLIDE 0 : INTRO -->
<div class="slide active" data-i="0">
    <p class="intro-sub">someone has a surprise for you</p>
    <div class="env-wrap" id="envWrap">
        <div class="envelope">
            <div class="env-body"><div class="env-inner"></div><div class="env-letter"><span>สุขสันต์วันวาเลนไทน์นะงับ</span></div></div>
            <div class="env-flap"></div>
            <div class="env-seal">&#9829;</div>
        </div>
    </div>
    <button class="start-btn" id="startBtn"><span>&#10084;&#65039; เปิดดูเลย</span></button>
</div>

<!-- SLIDE 1 : MESSAGE -->
<div class="slide" data-i="1">
    <div class="msg-card">
        <span class="icon">&#128140;</span>
        <div class="tw-text" id="twMsg"></div>
    </div>
</div>

<!-- SLIDE 2-6 : PHOTOS with captions -->
<div class="slide" data-i="2">
    <p class="photo-cap" id="cap2"></p>
    <div class="photo-frame" data-anim="a-pop"><img src="media/photo1.jpg" alt="us"></div>
    <span class="photo-counter">1 / 5</span>
</div>
<div class="slide" data-i="3">
    <p class="photo-cap" id="cap3"></p>
    <div class="photo-frame" data-anim="a-slideUp"><img src="media/photo2.jpg" alt="us"></div>
    <span class="photo-counter">2 / 5</span>
</div>
<div class="slide" data-i="4">
    <p class="photo-cap" id="cap4"></p>
    <div class="photo-frame" data-anim="a-zoom"><img src="media/photo3.jpg" alt="us"></div>
    <span class="photo-counter">3 / 5</span>
</div>
<div class="slide" data-i="5">
    <p class="photo-cap" id="cap5"></p>
    <div class="photo-frame" data-anim="a-rotateIn"><img src="media/photo4.jpg" alt="us"></div>
    <span class="photo-counter">4 / 5</span>
</div>
<div class="slide" data-i="6">
    <p class="photo-cap" id="cap6"></p>
    <div class="photo-frame" data-anim="a-drop"><img src="media/photo5.jpg" alt="us"></div>
    <span class="photo-counter">5 / 5</span>
</div>

<!-- SLIDE 7-9 : VIDEOS -->
<div class="slide" data-i="7">
    <div class="video-outer"><video id="vid1" playsinline preload="metadata" src="media/video1.mp4"></video></div>
    <p class="video-label">&#127916; Clip 1 / 3</p>
</div>
<div class="slide" data-i="8">
    <div class="video-outer"><video id="vid2" playsinline preload="metadata" src="media/video2.mp4"></video></div>
    <p class="video-label">&#127916; Clip 2 / 3</p>
</div>
<div class="slide" data-i="9">
    <div class="video-outer"><video id="vid3" playsinline preload="metadata" src="media/video3.mp4"></video></div>
    <p class="video-label">&#127916; Clip 3 / 3</p>
</div>

<!-- SLIDE 10 : FINALE -->
<div class="slide" data-i="10">
    <div class="ripple-layer" id="rippleLayer"></div>
    <div class="finale-bouquet" id="finaleBouquet"><img src="media/bouquet.png" alt="bouquet"></div>
    <div class="finale-lines" id="finaleLines"></div>
</div>

<button class="nav-next" id="nextBtn"><svg viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg></button>
<div class="prog" id="prog"></div>

<audio id="bgMusic" loop preload="auto"><source src="media/music.mp3" type="audio/mpeg"></audio>

<script>
/* =========================================================
   CONFIG
   ========================================================= */
const MSG = 'อาจไม่มีอะไรให้หนู\u{1F97A} แต่พี่ก็ตั้งใจทำ อันนี้ให้แทนนะงับ รักหนูนะงับ\u{1F970}';

const CAPTIONS = [
    'ดูเซ็กซี่นะงับ\u{1F618}',
    'เห็นรูปแล้วหายเหนื่อยเป็นปลิดทิ้งเลย กำลังใจที่ดีที่สุดของเค้า เจ้าหนู\u{1F970}\u{1F618}\u{1F498}',
    'ชอบเธอจังทำไมถึงหน้าหลงใหลขนาดนี้\u{1F970}\u{1F60D}',
    'เห็นใบหน้านี้ทีไร ทำให้คิดถึงไม่ไหวเลยงับ\u{1F97A}',
    'นี้มันชุดนอนไม่ได้นอนนี้น้า\u{1F970}'
];

const FINALE = [
    {t:'Happy Valentine\'s Day งับ\u{1F970}', type:'line'},
    {t:'อยู่กันไปนานนะงับ\u{1F618}', type:'line'},
    {t:'รักกัน\u{1F498}', type:'line'},
    {t:'คิดถึงกัน\u{2764}\u{FE0F}', type:'line'},
    {t:'แบบนี้ไปนานนะ\u{1F60D}', type:'line'},
    {t:'\u2022 \u2022 \u2726 \u2022 \u2022', type:'divider'},
    {t:'ไม่ใช่แค่วันนี้ที่รัก', type:'poem'},
    {t:'แต่อยากรักเธอในทุกวันธรรมดา', type:'poem'},
    {t:'ในวันที่เหนื่อย ในวันที่ท้อ', type:'poem'},
    {t:'ก็ยังมีเราอยู่ข้างกันเสมอ', type:'poem'},
    {t:'จนคำว่า "ตลอดไป" ไม่ใช่แค่คำพูด', type:'poem'},
    {t:'แต่เป็นชีวิตจริงของเรา \u{2764}\u{FE0F}\u{2728}', type:'poem', climax:true}
];

const DECOS=[
    {syms:['\u2726','\u2727','\u22C6'],color:'rgba(255,215,180,.3)'},       // 0 intro: sparkle stars
    {syms:['\u2661','\u2665','\u2764'],color:'rgba(255,150,180,.3)'},       // 1 msg: hearts
    {syms:['\u273F','\u2740','\u2741'],color:'rgba(255,180,200,.3)'},       // 2 photo1: flowers
    {syms:['\u2606','\u2727','\u22C6'],color:'rgba(200,180,255,.3)'},       // 3 photo2: stars
    {syms:['\u274B','\u2724','\u2725'],color:'rgba(255,200,180,.3)'},       // 4 photo3: ornaments
    {syms:['\u266A','\u266B','\u266C'],color:'rgba(255,180,220,.3)'},       // 5 photo4: music notes
    {syms:['\u2736','\u2739','\u273A'],color:'rgba(255,200,200,.3)'},       // 6 photo5: burst stars
    {syms:['\u2756','\u2666','\u25C7'],color:'rgba(180,200,255,.3)'},       // 7 vid1: diamonds
    {syms:['\u2726','\u2735','\u2738'],color:'rgba(220,180,255,.3)'},       // 8 vid2: stars
    {syms:['\u2742','\u2743','\u2749'],color:'rgba(255,190,230,.3)'}        // 9 vid3: florettes
];

const SLIDES=11, PHOTO_MS=6000, MSG_MS=3500;

/* =========================================================
   STATE
   ========================================================= */
let cur=0,moving=false,autoT=null,musicOn=false,started=false;

/* =========================================================
   DOM
   ========================================================= */
const S=document.querySelectorAll('.slide');
const music=document.getElementById('bgMusic');
const nBtn=document.getElementById('nextBtn');
const prog=document.getElementById('prog');
const muBtn=document.getElementById('muBtn');
const trans=document.getElementById('transOverlay');
const lb=document.getElementById('lightBurst');
const vid1=document.getElementById('vid1');
const vid2=document.getElementById('vid2');
const vid3=document.getElementById('vid3');
const finGlow=document.getElementById('finaleGlow');

/* =========================================================
   iOS VH FIX
   ========================================================= */
function setVH(){document.documentElement.style.setProperty('--vh',window.innerHeight*.01+'px')}
setVH(); window.addEventListener('resize',setVH);

/* =========================================================
   BACKGROUNDS
   ========================================================= */
function mkAmbient(){
    const c=document.getElementById('ambLight');
    const orbs=[
        {w:300,h:300,bg:'rgba(120,30,80,.15)',x:'15%',y:'75%',tx:'30px',ty:'-40px',d:'18s',o1:.12,o2:.06,s:1.3},
        {w:250,h:250,bg:'rgba(60,20,100,.12)',x:'80%',y:'15%',tx:'-25px',ty:'35px',d:'22s',o1:.1,o2:.05,s:1.2},
        {w:200,h:200,bg:'rgba(255,45,85,.06)',x:'50%',y:'50%',tx:'20px',ty:'-20px',d:'15s',o1:.08,o2:.04,s:1.4}
    ];
    orbs.forEach(o=>{
        const d=document.createElement('div');d.className='amb-orb';
        d.style.cssText=`width:${o.w}px;height:${o.h}px;background:${o.bg};left:${o.x};top:${o.y};--tx:${o.tx};--ty:${o.ty};--d:${o.d};--o1:${o.o1};--o2:${o.o2};--s:${o.s}`;
        c.appendChild(d);
    });
}

function mkStars(n){
    const c=document.getElementById('bgStars');
    for(let i=0;i<n;i++){
        const s=document.createElement('div');s.className='star';
        const z=Math.random()*2+.4;
        s.style.cssText=`width:${z}px;height:${z}px;left:${Math.random()*100}%;top:${Math.random()*100}%;--d:${Math.random()*5+3}s;--dl:${Math.random()*6}s`;
        c.appendChild(s);
    }
}

function mkHearts(n){
    const c=document.getElementById('bgHearts'),h=['\u2665','\u2764'];
    for(let i=0;i<n;i++){
        const d=document.createElement('div');d.className='fh';
        d.textContent=h[~~(Math.random()*h.length)];
        d.style.cssText=`left:${Math.random()*100}%;--sz:${Math.random()*10+8}px;--d:${Math.random()*16+10}s;--dl:${Math.random()*14}s;--dx:${(Math.random()-.5)*50}px;--mo:${Math.random()*.12+.06}`;
        c.appendChild(d);
    }
}

function mkBokeh(n){
    const c=document.getElementById('bgBokeh');
    const colors=['rgba(255,180,210,.5)','rgba(255,220,200,.4)','rgba(200,160,240,.4)','rgba(255,200,160,.3)'];
    for(let i=0;i<n;i++){
        const b=document.createElement('div');b.className='bokeh';
        const sz=Math.random()*30+10;
        b.style.cssText=`width:${sz}px;height:${sz}px;left:${Math.random()*100}%;top:${Math.random()*100}%;background:radial-gradient(circle,${colors[~~(Math.random()*colors.length)]},transparent 70%);--d:${Math.random()*25+15}s;--dl:${Math.random()*18}s;--dx:${(Math.random()-.5)*80}px;--dy:${(Math.random()-.5)*80}px;--mo:${Math.random()*.08+.03}`;
        c.appendChild(b);
    }
}

/* =========================================================
   PROGRESS
   ========================================================= */
function buildProg(){for(let i=1;i<SLIDES;i++){const d=document.createElement('span');d.className='pd';prog.appendChild(d)}}
function updProg(){prog.querySelectorAll('.pd').forEach((d,i)=>{const si=i+1;d.classList.toggle('cur',si===cur);d.classList.toggle('done',si<cur)})}

/* =========================================================
   SLIDE NAV
   ========================================================= */
function goTo(idx){
    if(moving||idx===cur||idx<0||idx>=SLIDES)return;
    moving=true;clrAuto();hideNext();
    const old=S[cur],nw=S[idx];
    trans.classList.add('on');
    old.classList.add('leaving');old.classList.remove('active');
    const oldF=old.querySelector('.photo-frame');
    if(oldF){oldF.classList.remove('anim-active','photo-float');oldF.style.opacity='0';oldF.style.transform='scale(0) rotate(-5deg)'}
    const oldC=old.querySelector('.photo-cap');if(oldC)oldC.innerHTML='';
    const oldV=old.querySelector('video');if(oldV){oldV.pause();oldV.currentTime=0}
    setTimeout(()=>{
        old.classList.remove('leaving');trans.classList.remove('on');
        cur=idx;nw.classList.add('active');updProg();onEnter(idx);moving=false;
    },700);
}
function goNext(){if(cur<SLIDES-1)goTo(cur+1)}
function showNext(ms){clrNext();nBtn._t=setTimeout(()=>nBtn.classList.add('show'),ms||0)}
function hideNext(){clrNext();nBtn.classList.remove('show')}
function clrNext(){clearTimeout(nBtn._t)}
function clrAuto(){clearTimeout(autoT)}

/* =========================================================
   SLIDE ENTER
   ========================================================= */
function onEnter(idx){
    if(idx===1)enterMsg();
    else if(idx>=2&&idx<=6)enterPhoto(idx);
    else if(idx>=7&&idx<=9)enterVideo(idx);
    else if(idx===10)enterFinale();
}

// -- Message --
function enterMsg(){
    const el=document.getElementById('twMsg');el.innerHTML='';
    typewrite(el,MSG,50,()=>{showNext(400);autoT=setTimeout(goNext,MSG_MS)});
}
function typewrite(el,txt,spd,cb){
    let i=0;const c=document.createElement('span');c.className='tw-cursor';el.appendChild(c);
    (function tick(){if(i<txt.length){el.insertBefore(document.createTextNode(txt[i]),c);i++;setTimeout(tick,spd)}else{setTimeout(()=>c.remove(),1200);if(cb)cb()}})();
}

// -- Photo --
function enterPhoto(idx){
    const capEl=document.getElementById('cap'+(idx));
    const frame=S[idx].querySelector('.photo-frame');
    const capText=CAPTIONS[idx-2];
    capEl.innerHTML='';
    frame.style.opacity='0';frame.style.transform='scale(0) rotate(-5deg)';
    frame.classList.remove('anim-active','photo-float');
    typewrite(capEl,capText,40,null);
    setTimeout(()=>{
        frame.style.opacity='';frame.style.transform='';
        frame.classList.add('anim-active',frame.dataset.anim);
    },400);
    setTimeout(()=>{frame.classList.add('photo-float')},1600);
    showNext(1800);
    autoT=setTimeout(goNext,PHOTO_MS);
}

// -- Video --
function enterVideo(idx){
    fadeVol('out',400);
    const v=idx===7?vid1:idx===8?vid2:vid3;v.currentTime=0;v.play().catch(()=>{});
    v.onended=function(){clrAuto();goNext()};
    showNext(1500);autoT=setTimeout(goNext,60000);
}

// -- Finale --
function enterFinale(){
    fadeVol('in',800);launchPetals(40);
    finGlow.classList.add('on');startRipples();
    const bq=document.getElementById('finaleBouquet');
    setTimeout(()=>bq.classList.add('float'),1800);
    const c=document.getElementById('finaleLines');c.innerHTML='';
    const delay0=2000, gap=1200;
    FINALE.forEach((item,i)=>{
        const p=document.createElement('p');
        p.className=item.type==='divider'?'finale-divider':item.type==='poem'?'finale-poem':'finale-line';
        if(item.climax)p.classList.add('climax');
        p.textContent=item.t;c.appendChild(p);
        setTimeout(()=>{
            p.classList.add('shown');
            p.scrollIntoView({behavior:'smooth',block:'nearest'});
        },delay0+i*gap);
    });
    setTimeout(()=>launchConfetti(80),delay0+FINALE.length*gap+400);
    setTimeout(()=>launchConfetti(40),delay0+FINALE.length*gap+2500);
}

/* =========================================================
   MUSIC
   ========================================================= */
function startMusic(){
    music.volume=1;
    music.play().then(()=>{musicOn=true;muBtn.classList.add('show');muBtn.classList.remove('muted')}).catch(e=>{
        console.log('Music err:',e);
        document.addEventListener('touchstart',function r(){music.play().then(()=>{musicOn=true;muBtn.classList.add('show')}).catch(()=>{});document.removeEventListener('touchstart',r)},{once:true});
    });
}
function fadeVol(dir,dur){
    const steps=20,iv=dur/steps,sv=1/steps;let step=0;
    if(dir==='out'){const f=setInterval(()=>{step++;music.volume=Math.max(0,1-sv*step);if(step>=steps){clearInterval(f);music.pause();music.volume=0}},iv)}
    else{music.volume=0;music.play().catch(()=>{});musicOn=true;muBtn.classList.remove('muted');const f=setInterval(()=>{step++;music.volume=Math.min(1,sv*step);if(step>=steps){clearInterval(f);music.volume=1}},iv)}
}
function toggleMu(){if(musicOn){music.pause();musicOn=false;muBtn.classList.add('muted')}else{music.play();musicOn=true;muBtn.classList.remove('muted')}}

/* =========================================================
   FX
   ========================================================= */
function sparkle(x,y){
    const sym=['\u2022','\u2726','\u2727','\u2605'];
    for(let i=0;i<5;i++){const s=document.createElement('div');s.className='sparkle';s.textContent=sym[~~(Math.random()*sym.length)];const a=Math.PI*2/5*i+Math.random()*.5,dist=Math.random()*45+20;s.style.cssText=`left:${x}px;top:${y}px;--dx:${Math.cos(a)*dist}px;--dy:${Math.sin(a)*dist}px;font-size:${~~(Math.random()*6+8)}px;color:hsl(${340+~~(Math.random()*30)},70%,${65+~~(Math.random()*15)}%)`;document.body.appendChild(s);setTimeout(()=>s.remove(),900)}
}
function launchConfetti(n){
    const cols=['#ff2d55','#ff6b9d','#ffd700','#e91e63','#d4a0e8','#f48fb1'],sym=['\u2665','\u2764','\u2726','\u2727'];
    for(let i=0;i<n;i++){const c=document.createElement('div');c.className='confetti';const xs=(Math.random()-.5)*150,xe=xs+(Math.random()-.5)*250;if(Math.random()>.4){c.textContent=sym[~~(Math.random()*sym.length)];c.style.color=cols[~~(Math.random()*cols.length)];c.style.fontSize=(~~(Math.random()*12+8))+'px'}else{c.style.cssText+=`width:${~~(Math.random()*6+4)}px;height:${~~(Math.random()*6+4)}px;background:${cols[~~(Math.random()*cols.length)]};border-radius:50%`}c.style.cssText+=`;left:${Math.random()*100}vw;--xs:${xs}px;--xe:${xe}px;--fd:${Math.random()*2.5+2}s;--dl:${Math.random()*.8}s`;document.body.appendChild(c);setTimeout(()=>c.remove(),5500)}
}
function launchPetals(n){
    for(let i=0;i<n;i++){const p=document.createElement('div');p.className='petal';p.style.cssText=`left:${Math.random()*100}vw;--d:${Math.random()*4+3}s;--dl:${Math.random()*5}s;--dx:${(Math.random()-.5)*80}px;--rot:${~~(Math.random()*600+200)}deg;width:${~~(Math.random()*6+6)}px;height:${~~(Math.random()*8+8)}px`;document.body.appendChild(p);setTimeout(()=>p.remove(),9000)}
}

/* =========================================================
   WATER RIPPLE (FINALE)
   ========================================================= */
let rippleIv=null;
function startRipples(){
    const layer=document.getElementById('rippleLayer');
    if(!layer)return;
    function spawnRipple(){
        const x=15+Math.random()*70, y=15+Math.random()*70;
        const baseSz=120+Math.random()*180;
        const baseDur=3+Math.random()*2;
        for(let i=0;i<3;i++){
            const r=document.createElement('div');r.className='ripple-ring';
            const sz=baseSz*(0.7+i*0.2);
            const dur=baseDur+i*0.4;
            r.style.cssText=`left:${x}%;top:${y}%;--sz:${sz}px;--d:${dur}s;animation-delay:${i*0.25}s`;
            layer.appendChild(r);
            setTimeout(()=>r.remove(),(dur+i*0.25)*1000+200);
        }
    }
    spawnRipple();
    rippleIv=setInterval(spawnRipple,2200);
}
function stopRipples(){clearInterval(rippleIv);rippleIv=null}

/* =========================================================
   SLIDE DECORATIONS
   ========================================================= */
function mkDecos(){
    for(let si=0;si<10;si++){
        const slide=S[si];
        const deco=DECOS[si];
        const count=5+Math.floor(Math.random()*2);
        for(let i=0;i<count;i++){
            const d=document.createElement('span');
            d.className='slide-deco';
            d.textContent=deco.syms[Math.floor(Math.random()*deco.syms.length)];
            const isTop=i<count/2;
            const x=6+Math.random()*88;
            const y=isTop?(2+Math.random()*12):(83+Math.random()*13);
            const sz=10+Math.random()*10;
            const dur=4+Math.random()*5;
            const delay=Math.random()*6;
            const tx=(Math.random()-.5)*18;
            const ty=(Math.random()-.5)*10;
            const rot=5+Math.random()*20;
            d.style.cssText=`left:${x}%;top:${y}%;--sz:${sz}px;--d:${dur}s;--dl:${delay}s;--dc:${deco.color};--tx:${tx}px;--ty:${ty}px;--r:${rot}deg;--o1:${(.1+Math.random()*.1).toFixed(2)};--o2:${(.25+Math.random()*.15).toFixed(2)}`;
            slide.appendChild(d);
        }
    }
}

/* =========================================================
   OPEN ENVELOPE
   ========================================================= */
function openEnv(){
    if(started)return;started=true;
    document.getElementById('envWrap').classList.add('opened');
    setTimeout(()=>lb.classList.add('on'),500);
    setTimeout(()=>{startMusic();lb.classList.remove('on');prog.classList.add('show');goTo(1)},1500);
}

/* =========================================================
   SWIPE
   ========================================================= */
let touchX=0;
document.addEventListener('touchstart',e=>{touchX=e.changedTouches[0].screenX},{passive:true});
document.addEventListener('touchend',e=>{const d=touchX-e.changedTouches[0].screenX;if(d>60&&cur>0&&cur<SLIDES-1)goNext()},{passive:true});

/* =========================================================
   INIT
   ========================================================= */
function init(){
    mkAmbient();mkStars(90);mkHearts(12);mkBokeh(20);mkDecos();buildProg();
    document.getElementById('startBtn').addEventListener('click',openEnv);
    document.getElementById('envWrap').addEventListener('click',openEnv);
    nBtn.addEventListener('click',goNext);
    muBtn.addEventListener('click',toggleMu);
    document.addEventListener('click',e=>{if(cur>0)sparkle(e.clientX,e.clientY)});
    music.load();
}
if(document.fonts&&document.fonts.ready)document.fonts.ready.then(init);
else document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>
